.TH "Hyenae" "1" "Jan. 2009" "Robin Richter" "Hyenae Users Manual"
.SH NAME
hyenae - Advanced Network Packet Generator
.SH SYNOPSIS
hyenae  [\fB-s\fR src-pat] [\fB-d\fR dst-pat] [\fB-S\fR snd-pat] [\fB-T\fR trg-pat]
        [\fB-a\fR att-type] [\fB-p\fR rnd-payload] [\fB-P\fR payload-file]
        [\fB-i\fR if-n] [\fB-I\fR if-i] [\fB-c\fR min-cnt] [\fB-C\fR max-cnt]
        [\fB-e\fR min-del] [\fB-E\fR max-del] [\fB-u\fR min-dur] [\fB-U\fR max-dur]
        [\fB-A\fR ip-v-asm] [\fB-t\fR ip-ttl] [\fB-r\fR srv-pat] [\fB-R\fR srv-file]
        [\fB-f\fR tcp-flags] [\fB-q\fR tcp-seq] [\fB-Q\fR tcp-seq-ins]
        [\fB-k\fR tcp-ack] [\fB-w\fR tcp-win] [\fB-mnlLV\fR]

.SH DESCRIPTION
Hyenae is a highly flexible and platform independent network packet generator.
It allows you to reproduce low level ethernet attack scenarios (such as MITM,
DoS and DDoS) to reveal the potential security vulnerabilities of your
network. Besides smart wildcard-based address randomization and a highly
customizable packet generation control, Hyenae comes with a clusterable remote
daemon for setting up distributed attack networks.

Hyenae was developed with ease of use in mind while still remaining flexible
and configurable. To realize this aim, Hyenae uses address patterns, which
will minimize the number of arguments you have to provide because all
necessary parameters, such as the way you want to randomize your addresses or
the IP address version to use, can be derived from the pattern format you
provided. See section 4, "Address Patterns", for more detailed information.

This utility suite was developed for network security testing purposes such
as firewall rules, flood detection and intrusion detection testing only. The
author is not responsible for any illegal use or actions, or damage caused by
or with a utility of this suite.

.SH OPTIONS
\fB-s\fR    Source address pattern

\fB-d\fR    Destination address pattern

\fB-a\fR    Attack type. A list of all
      available attacks can be obtained by
      starting Hyenae with the -L option.

\fB-p\fR    Random packet payload. If set,
      a random data block (payload) of the
      given length will be added to the
      generated packets (if supported by the
      chosen attack type). By default all
      packets will be generated with an
      empty data block. If the total length
      of the packet (including the protocol
      headers) would exceed the MTU limit
      and Hyenae was called without the -m
      option, it will give out an error. The
      total length of a packet depends on IP
      protocol and the attack type used. The
      default MTU limit is 1500 bytes.

\fB-P\fR    File-based packet payload. If
      set, the contents of a file at the
      given path will be added as the data
      block (payload) of the generated
      packets. If the total length of the
      packet (including the protocol
      headers) would exceed the MTU limit
      and Hyenae was called without the
      -m option, it will give out an error.
      The total length of a packet depends
      on IP protocol and the attack type
      used. The default MTU limit is 1500
      bytes.

\fB-S\fR    ARP-Reply sender address pattern

\fB-T\fR    ARP-Reply target address pattern

\fB-i\fR    Network interface to operate on
      (specified by name). This argument is
      ignored on remote attacks.

\fB-I\fR    Network interface to operate on
      (specified by index). A list of all
      available network interfaces and their
      indices can be obtained by starting
      Hyenae with the -l option. This
      argument is ignored on remote attacks.

\fB-c\fR    Minimum number of packets to
      generate. If not set or set to 0, an
      unlimited amount of packets will be
      generated, unless an attack duration
      was set. If you provide a maximum
      number of packets to generate, the
      minimum number of packets will be
      automatically set to one. If not set
      or set to 0 on remote attacks, the
      packet limit of the daemon will be
      used instead.

\fB-C\fR    Maximum number of packets to
      generate. If not set or set to 0, the
      specified minimum number of packets
      (-c X) will be generated. If no
      minimum number of packets to generate
      is specified, an unlimited amount of
      packets will be generated.

\fB-e\fR    Minimum number of milliseconds
      to wait until the next packet is sent.

\fB-E\fR    If set, Hyenae will wait a
      random number of milliseconds between
      the minimum (-e X or 0 if not set) and
      the maximum number (-E X) before
      sending the next packet. This is
      useful for breaking flood detections.

\fB-u\fR    Minimum attack duration in
      milliseconds. If not set or set to 0,
      the attack duration will be endless,
      unless a packet count was given. If
      not set or set to 0 on remote attacks,
      the attack duration limit of the
      daemon will be used instead.

\fB-U\fR    If set, Hyenae will stop the
      attack when a duration of a random
      number of milliseconds between the
      minimum (-u X or 0 if not set) and the
      maximum number (-U X) is reached.

\fB-t\fR    Defines the hop limit (TTL) on
      IP based attacks. The hop limit can be
      a value between 1 and 255. If not set,
      a hop limit size of 128 will be used.

\fB-f\fR    TCP flags. This option is
      required on TCP attacks and defines
      the TCP control flags to set for the
      generated packets. Valid values are
      any combination of: F (FIN), S (SYN),
      R (RST), P (PSH), A (ACK)

\fB-q\fR    TCP sequence number. Defines the
      TCP sequence number to use on TCP
      based attacks. If not set or set to 0,
      every generated packet (unless a step
      value was given) will carry a
      completely randomized sequence number.
      If a TCP sequence number
      incrementation step value was given,
      this argument will be used as the
      initial sequence number to be
      incremented.

\fB-Q\fR    TCP sequence number
      incrementation steps. If set, the
      sequence number of every generated
      packet on TCP based attacks will be
      incremented by the given value.

\fB-k\fR    TCP acknowledgement number.
      Defines the TCP acknowledgement number
      to use on TCP based attacks. If not
      set or set to 0, an acknowledgement
      number of 0 will be used.

\fB-w\fR    TCP window size. Defines the TCP
      window size to use on TCP based
      attacks. If not set or set to 0, a
      window size of 0 will be used.

\fB-A\fR    IP address version to assume
      when a completely random IP strip is
      found within an address pattern. This
      value can be either 4 or 6. By default
      this is set to 4 (IPv4).

\fB-r\fR    Single remote attack. If set,
      Hyenae will execute the specified
      attack on the Hyenae Daemon specified
      by the given server address pattern. A
      server address pattern has the
      following pattern format:

        // For plain connections
        [HW-Address]@[IP-Address]

        // For password protected daemons
        [HW-Address]@[IP-Address]+[Password]

      Hyenae will automatically recognize
      the provided IP address version.
      Wildcards are not valid within server
      address patterns. The password strip
      is only required when connecting to a
      Hyenae Daemon which has activated
      password authentication. Note: Since
      Hyenae currently does not support
      encrypted communication, your password
      is transfered in plain text, and can
      be logged by others.

\fB-R\fR    Clustered remote attack. If set,
      hyenae will simultaneously execute the
      specified attack on the Hyenae Daemons
      specified in the server file at the
      given path. A server list file should
      have the following format:

        # Comment
        Server=[HW-Address]@[IP-Address]
        Server=[HW-Address]@[IP-Address]+[Password]
        ...

      Hyenae will automatically recognize
      the provided IP address version.
      Wildcards are not valid within server
      address patterns. The password strip
      is only required when connecting to a
      Hyenae Daemon which has activated
      password authentication. Note: Since
      Hyenae currently does not support
      encrypted communication, your password
      is transfered in plain text, and can
      be logged by others.

\fB-m\fR    If set, the default MTU limit of
      1500 bytes will be ignored and even
      packets with a length greater than
      1500 bytes will by sent. If the packet
      length exceeds the supported MTU limit,
      pcap will fail to write the data to the
      network. You should never provide this
      option unless you know what you are
      doing.

\fB-n\fR    No sending (cold run). If set,
      Hyenae will start a run through its
      attack routines without actually
      writing any data to the network. This
      can be very useful to pre-check the
      generated packets or the remote daemon
      behaviour before executing the actual
      attack.

\fB-l\fR    Prints a list of all available
      network interfaces and exits.

\fB-l\fR    Prints a list of all available
      attacks  and exits.

\fB-V\fR    Prints the current version of
      Hyenae and exits.

.SH ADDRESS PATTERNS
Hyenae uses address patterns to define the source and destination address
(and for ARP-Replies, sender and target as well) of the generated packets.
Each pattern can contain wildcards to randomize certain octets or even the
whole address strip or port. Hyenae uses an address adequate randomization
algorithm that makes sure to produce valid addresses. As an example, if you
have a pattern with an IP address strip like 25%.168.0.1, Hyenae will
recognize that it can only place a random value from 0 to 5 here. It will
also use the required notation (decimal or hexadecimal) and detect that the
specified address is an IPv4 address and will use the IPv4 protocol for the
given attack (if possible). Address patterns can have the following formats:

  [HW-Address]-[IP-Address]@[Port]
  [HW-Address]-[IP-Address]
  [HW-Address]

Hyenae will automatically recognize the pattern and even every single
address format (HW, IPv4 or IPv4), so you don't have to pass extra arguments,
everything we need to know can be derived from the given pattern. If you want
to randomize a complete address strip (HW-Address or IP-Address) simply put a
single % in it:

  %-192.1%%.%.%%@%2%

This one will use a random hardware address and a partially randomized IP
address, adequate to the octet digits you specified. Notice that you can
even specify the number of random octet digits to create (but make sure that
the number of digits within the octet is valid for the used format), the last
octet of the IP address strip will be a random 2 digit value. The same works
within the port strip (separated by an '@'), the more wildcards you place,
the more digits the random port number will have. In the example above, the
port number will be 3 digits long and will also have a 2 within its center.
Here are some examples:

  // Ok
  00:D2:F%:D4:DD:%%-192.168.%%.%@%%
  %-192.168.%%%.%@%%
  00:D2:F%:D4:DD:%%-%@%%
  %-%@%
  %-%

  // Error: HW address octets have a fixed length of 2 digits!
  00:%:00::00:00:00-192.168.0.1@21

If you are using only a single wildcard as the IP address strip, Hyenae will
generate a complete random IP address. By default, Hyenae will interpret or
"assume" random IP address strips as IPv4 addresses. You can change the
assumed version by calling Hyenae with the -A option.

.SH ATTACK SYNOPSIS
  hyenae -a arp-reply
         -s [MAC-Address]
         -d [MAC-Address]
         -S [MAC-Address]-[IP-Address (IPv4 only)]
         -T [MAC-Address]-[IP-Address (IPv4 only)]

  hyenae -a arp-request
         -s [MAC-Address]
         -d [MAC-Address]
         -S [MAC-Address]-[IP-Address (IPv4 only)]
         -T [MAC-Address]-[IP-Address (IPv4 only)]

  hyenae -a icmp-echo
         -s [MAC-Address]-[IP-Address (IPv4 or IPv6)]
         -d [MAC-Address]-[IP-Address (IPv4 or IPv6)]

  hyenae -a tcp
         -s [MAC-Address]-[IP-Address (IPv4 or IPv6)]@[Port]
         -d [MAC-Address]-[IP-Address (IPv4 or IPv6)]@[Port]
         -f [TCP-Flags]

  hyenae -a udp
         -s [MAC-Address]-[IP-Address (IPv4 or IPv6)]@[Port]
         -d [MAC-Address]-[IP-Address (IPv4 or IPv6)]@[Port]

.SH SEE ALSO
  hyenaed(1)

.SH AUTHOR
  Robin Richter (richterr@users.sourceforge.net)
